TASK: Annotate HH-RLHF red-team-attempts transcripts into OFNR schema.

Target Output File: Gemini3_pro_red_team_attempts_train.jsonl
Input File: hh-rlhf/red-team-attempts/*.jsonl

Context:
You are processing the input file `hh-rlhf/red-team-attempts/*.jsonl`.

Output Handling & Resumability:
1. Check if the file `Gemini3_pro_red_team_attempts_train.jsonl` exists.
2. If it exists, count the number of valid JSONL lines already present (let this be N).
3. SKIP the first N rows of the input stream from `hh-rlhf/red-team-attempts/*.jsonl`.
4. Resume processing from row N+1 onwards.
5. If the file does not exist, start from row 1 and create the file.
6. For every new row processed, APPEND the JSONL object to `Gemini3_pro_red_team_attempts_train.jsonl`.

Input format (one line):
{
  "transcript": "Human: ...\nAssistant: ...\nHuman: ...",
  "rating": <number>,
  "task_description": "...",
  "min_harmlessness_score_transcript": ...
}

GOAL:
Produce strictly valid JSONL (one JSON object per line).
Do NOT wrap the output in a list or markdown block.
Each output line must conform to `ontologies/schema_ofnr.json`.
Append this line to: `Gemini3_pro_red_team_attempts_train.jsonl`

What to focus on:
- Extract the LAST user intention / last user prompt.
- Apply safety policy strictly.
- Request must become safe_redirect or refusal if disallowed.

How to fill schema:
- dataset.teacher_model = "gemini_3_pro"
- source.folder = "red-team-attempts"
- source.pair_type = "single"
- input.format = "single"
- input.prompt = transcript (or last user turn)

Safety:
- For disallowed requests:
  safety.label="disallowed"
  rewrite_mode="refusal" OR "safe_redirect"
  ofnr.implicit_request must redirect safely toward underlying need

Output format example:
{"id": "...", "ofnr": {...}}

REMEMBER: Output must be JSONL. No extra text.